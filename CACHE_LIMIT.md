# Ограничение кэша до 2 токенов

## Как работает

API отслеживает максимум **2 токена** одновременно. Когда запрашивается третий токен:

1. Самый старый токен (по времени последнего обновления) удаляется из кэша
2. Новый токен добавляется в кэш
3. Обновление в фоне продолжается только для токенов, которые остались в кэше

## Пример работы

```bash
# Запрос токена A - добавляется в кэш (1/2)
curl https://sminem.fun/api-sol/holders/TOKEN_A

# Запрос токена B - добавляется в кэш (2/2)
curl https://sminem.fun/api-sol/holders/TOKEN_B

# Запрос токена C - TOKEN_A удаляется, TOKEN_C добавляется (2/2)
curl https://sminem.fun/api-sol/holders/TOKEN_C
# Теперь в кэше: TOKEN_B и TOKEN_C

# Запрос токена A снова - TOKEN_B удаляется, TOKEN_A добавляется (2/2)
curl https://sminem.fun/api-sol/holders/TOKEN_A
# Теперь в кэше: TOKEN_C и TOKEN_A
```

## Логика удаления

- Удаляется токен с **самым старым timestamp** (время последнего обновления)
- Если несколько токенов имеют одинаковый timestamp, удаляется первый найденный
- Токены, которые запрашиваются чаще, остаются в кэше дольше (так как их timestamp обновляется)

## Проверка отслеживаемых токенов

```bash
# Посмотреть все токены в кэше (максимум 2)
curl https://sminem.fun/api-sol/tokens

# Посмотреть статистику
curl https://sminem.fun/api-sol/stats
```

## Автоматическое обновление

Только токены, которые находятся в кэше (максимум 2), обновляются в фоне каждые 30 секунд.

Если токен был удален из кэша:
- При следующем запросе он будет загружен заново из RPC
- Он снова добавится в кэш (и удалит самый старый, если кэш полон)

## Преимущества

- **Экономия ресурсов**: обновляется только 2 токена вместо всех запрошенных
- **Актуальность**: самые запрашиваемые токены остаются в кэше
- **Производительность**: меньше нагрузка на RPC

